/* -------------- Base tokens by our theme -------------- */
html[data-cosmo-theme="nebula"] {
	--cosmo-bg: radial-gradient(1200px 800px at 10% -20%, #3a2b75 0%, transparent 60%),
	            radial-gradient(1200px 800px at 110% 120%, #0b6aa9 0%, transparent 60%),
	            #0b0b12;
	--cosmo-card: rgba(255,255,255,0.06);
	--cosmo-border: rgba(255,255,255,0.14);
	--cosmo-glow: 0 0 0 1px rgba(141, 162, 255, 0.25), 0 10px 30px rgba(60, 120, 255, 0.18);
	--cosmo-blur: saturate(1.2) blur(6px);
	--cosmo-text: #e8ecff;
	--cosmo-subtle: #9aa6c3;
}

/* === Cosmo: unify header action buttons === */
button[data-testid="model-switcher-dropdown-button"],
button[data-testid="share-chat-button"],
button[data-testid="conversation-options-button"] {
	border: 1px solid var(--cosmo-border) !important;
	box-shadow: var(--cosmo-glow);
	border-radius: 12px !important;
	transition: transform .12s ease, box-shadow .12s ease;
}
button[data-testid="share-chat-button"]:hover,
button[data-testid="conversation-options-button"]:hover {
	transform: translateY(-1px);
}

/* === Cosmo: in-chat action icon hover === */
button[data-testid*="-turn-action-button"] {
	transition: background-color .12s ease;
}
button[data-testid*="-turn-action-button"]:hover {
	background-color: rgba(255, 255, 255, .06);
}

/* === Cosmo: slim sidebar icon hover === */
#stage-sidebar-tiny-bar [__menu-item] {
	transition: background-color .12s ease;
}
#stage-sidebar-tiny-bar [__menu-item]:hover {
	background-color: rgba(255, 255, 255, .05);
}

/* Glassy variant */
html[data-cosmo-theme="glass"] {
	--cosmo-bg: linear-gradient(120deg, #0e0f14, #0b1116 40%, #0e0f14 100%);
	--cosmo-card: rgba(255,255,255,0.04);
	--cosmo-border: rgba(255,255,255,0.12);
	--cosmo-glow: 0 0 0 1px rgba(255,255,255,0.08), 0 12px 36px rgba(0,0,0,0.35);
	--cosmo-blur: blur(10px);
	--cosmo-text: #f2f4f8;
	--cosmo-subtle: #a8b0bd;
}

/* Monochrome variant */
html[data-cosmo-theme="mono"] {
	--cosmo-bg: #0e0f11;
	/* semi-transparent so backdrop-filter is visible */
	--cosmo-card: rgba(21, 23, 26, 0.72);
	--cosmo-border: #262a2f;
	--cosmo-glow: 0 0 0 1px #262a2f;
	/* enable frosted look on mono */
	--cosmo-blur: blur(8px);
	--cosmo-text: #e6e7e9;
	--cosmo-subtle: #a3a7ad;
}

/* Sunset (warm) */
html[data-cosmo-theme="sunset"] {
	--cosmo-bg: radial-gradient(1200px 800px at 10% -20%, #5e2140 0%, transparent 60%),
	            radial-gradient(1200px 800px at 110% 120%, #ff8a00 0%, transparent 60%),
	            #0b0b12;
	--cosmo-card: rgba(255, 221, 204, .06);
	--cosmo-border: rgba(255, 221, 204, .18);
	--cosmo-glow: 0 0 0 1px rgba(255,160,122,.25), 0 10px 30px rgba(255,140,0,.18);
	--cosmo-blur: saturate(1.1) blur(6px);
	--cosmo-text: #ffe9df;
	--cosmo-subtle: #ffcfb7;
}

/* Vapor (cool teal/purple) */
html[data-cosmo-theme="vapor"] {
	--cosmo-bg: radial-gradient(1200px 800px at 10% -20%, #3b1a5a 0%, transparent 60%),
	            radial-gradient(1200px 800px at 110% 120%, #007a7a 0%, transparent 60%),
	            #0b0b12;
	--cosmo-card: rgba(255,255,255,.07);
	--cosmo-border: rgba(255,255,255,.16);
	--cosmo-glow: 0 0 0 1px rgba(127,255,212,.22), 0 10px 30px rgba(147,112,219,.2);
	--cosmo-blur: blur(8px);
	--cosmo-text: #eafcff;
	--cosmo-subtle: #b3e6e9;
}

/* High contrast */
html[data-cosmo-theme="contrast"] {
	--cosmo-bg: #0a0b0e;
	/* semi-transparent so backdrop-filter is visible */
	--cosmo-card: rgba(18, 20, 26, 0.75);
	--cosmo-border: #2b3240;
	--cosmo-glow: 0 0 0 1px #2b3240;
	/* enable frosted look on contrast */
	--cosmo-blur: blur(8px);
	--cosmo-text: #f3f6ff;
	--cosmo-subtle: #c2c9d6;
}

/* -------------- Page canvas -------------- */
/* Top-level HTML is marked with class 'dark' and data-chat-theme — we stay compatible. */
html.dark { background: var(--cosmo-bg) !important; color: var(--cosmo-text); }

/* -------------- Header polish -------------- */
/* Header has id='page-header' and carries bg-token-main-surface-primary we can override. */
#page-header {
	background: linear-gradient(90deg, rgba(12,12,22,0.7), rgba(12,12,22,0.45)) !important;
	backdrop-filter: var(--cosmo-blur);
	border-bottom: 1px solid var(--cosmo-border);
	box-shadow: var(--cosmo-glow);
}

/* Model switcher button is identified by data-testid */
button[data-testid="model-switcher-dropdown-button"] {
	border: 1px solid var(--cosmo-border) !important;
	box-shadow: var(--cosmo-glow);
	transition: transform .12s ease;
}
button[data-testid="model-switcher-dropdown-button"]:hover { transform: translateY(-1px); }

/* -------------- Sidebar glass -------------- */
/* Sidebar slim rail id='stage-sidebar-tiny-bar' */
#stage-sidebar-tiny-bar {
	background: var(--cosmo-card) !important;
	border-right: 1px solid var(--cosmo-border);
	backdrop-filter: var(--cosmo-blur);
}

/* -------------- New Chat button -------------- */
/* The “New chat” launch anchor has data-testid we can glow. */
a[data-testid="create-new-chat-button"] {
	background: linear-gradient(135deg, #6a5cff, #00c2ff) !important;
	color: white !important;
	border: none !important;
	box-shadow: 0 8px 24px rgba(0, 194, 255, 0.25), 0 2px 8px rgba(106, 92, 255, 0.3);
}

/* -------------- Main & thread zones -------------- */
#main, #thread {
	/* Gentle polish to the scroll surface */
	scrollbar-width: thin;
	scrollbar-color: #3a4a64 transparent;
}

/* -------------- Generic utility overrides -------------- */
/* Utility class seen on header/skip link: bg-token-main-surface-primary */
.bg-token-main-surface-primary {
	background: transparent !important;
}

/* “Skip to content” chip can float nicely over our background */
a[data-skip-to-content] {
	background: var(--cosmo-card) !important;
	border: 1px solid var(--cosmo-border) !important;
	backdrop-filter: var(--cosmo-blur);
	color: var(--cosmo-text) !important;
}


/* === Cosmo: extended polish === */

/* Header & sidebar depth */
#page-header {
	background: linear-gradient(90deg, rgba(12,12,22,.75), rgba(12,12,22,.5)) !important;
	backdrop-filter: var(--cosmo-blur);
	border-bottom: 1px solid var(--cosmo-border);
	box-shadow: var(--cosmo-glow), inset 0 -1px 0 rgba(255,255,255,.03);
	border-radius: 0 0 14px 14px;
}

#stage-sidebar-tiny-bar {
	background: var(--cosmo-card) !important;
	border-right: 1px solid var(--cosmo-border);
	backdrop-filter: var(--cosmo-blur);
	box-shadow: inset -1px 0 0 rgba(255,255,255,.03);
}

/* Buttons & core controls */
a[data-testid="create-new-chat-button"],
button[data-testid="model-switcher-dropdown-button"] {
	transition: transform .12s ease, box-shadow .12s ease, filter .12s ease;
	border-radius: 12px !important;
}
a[data-testid="create-new-chat-button"]:hover { transform: translateY(-1px); filter: brightness(1.05); }
button[data-testid="model-switcher-dropdown-button"]:active { transform: translateY(0); filter: brightness(.98); }

/* Main/thread readability */
#main, #thread { color: var(--cosmo-text); line-height: 1.5; }
#thread p, #thread li, #thread blockquote { color: var(--cosmo-text); }
#thread small, #thread time, #thread figcaption { color: var(--cosmo-subtle); }

/* Code blocks */
#thread pre, #thread code { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
#thread pre {
	background: rgba(0,0,0,.35);
	border: 1px solid var(--cosmo-border);
	border-radius: 12px;
	padding: 12px 14px;
	box-shadow: 0 12px 32px rgba(0,0,0,.25);
}
#thread code:not(pre code) {
	background: rgba(255,255,255,.06);
	border: 1px solid var(--cosmo-border);
	border-radius: 6px;
	padding: .1em .35em;
}

/* Menus & popovers */
[role="menu"], [role="listbox"], [data-radix-popper-content-wrapper] > div,
div[popover], .popover, .dropdown, .menu {
	background: var(--cosmo-card) !important;
	border: 1px solid var(--cosmo-border) !important;
	backdrop-filter: var(--cosmo-blur);
	box-shadow: var(--cosmo-glow);
	border-radius: 12px !important;
}
[role="menu"] [role="menuitem"],
[role="listbox"] [role="option"] { border-radius: 8px; }
[role="menu"] [role="menuitem"]:hover,
[role="listbox"] [role="option"][aria-selected="true"] {
	background: rgba(255,255,255,.06);
}

/* Focus visibility */
:where(button, a, input, select, textarea):focus-visible {
	outline: none;
	box-shadow: 0 0 0 2px rgba(255,255,255,.12), 0 0 0 4px rgba(0, 194, 255, .35);
	border-radius: 10px;
}

/* Unified slim scrollbars across panels */
* { scrollbar-width: thin; scrollbar-color: #3a4a64 transparent; }

/* Motion respect */
@media (prefers-reduced-motion: reduce) {
	* { transition: none !important; animation: none !important; }
}

/* Contrast variant tweaks */
html[data-cosmo-theme="contrast"] #page-header,
html[data-cosmo-theme="contrast"] #stage-sidebar-tiny-bar {
	background: var(--cosmo-card) !important;
}

/* === Cosmo accents and chatbar/sidebar coverage === */
:root { --cosmo-accent-1:#6a5cff; --cosmo-accent-2:#00c2ff; }
html[data-cosmo-theme="glass"]   { --cosmo-accent-1:#6f7cff; --cosmo-accent-2:#9be7ff; }
html[data-cosmo-theme="mono"]    { --cosmo-accent-1:#4a86ff; --cosmo-accent-2:#7dd3fc; }
html[data-cosmo-theme="sunset"]  { --cosmo-accent-1:#ff7a59; --cosmo-accent-2:#ffd38a; }
html[data-cosmo-theme="vapor"]   { --cosmo-accent-1:#8a63d2; --cosmo-accent-2:#34d5d5; }
html[data-cosmo-theme="contrast"]{ --cosmo-accent-1:#9ab6ff; --cosmo-accent-2:#78e2ff; }

/* New Chat uses the current theme's accent */
a[data-testid="create-new-chat-button"]{
	background: linear-gradient(135deg,var(--cosmo-accent-1),var(--cosmo-accent-2)) !important;
	color:#fff !important; border:none !important;
	box-shadow: 0 10px 24px rgba(0,0,0,.25), 0 2px 10px rgba(0,0,0,.2);
	transition: transform .12s ease, filter .12s ease;
}
a[data-testid="create-new-chat-button"]:hover{ transform:translateY(-1px); filter:brightness(1.05); }

 

/* ----- Force the site canvas to use our theme background ----- */
html, body { background: var(--cosmo-bg) !important; }

/* Neutralize site wrappers so our BG shows through */
#__next,
main[role="main"],
#main,
#thread,
[data-testid="stretched-body"],
.bg-token-main-surface-primary,
.bg-token-main-surface-secondary,
.bg-token-main-surface-tertiary {
	background: transparent !important;
}

/* Keep a smooth, fixed gradient feel */
html, body { background-attachment: fixed; }

/* ===== consolidated into Unified Glass Composer ===== */

/* === Cosmo: remove custom theming for New Chat button === */
a[data-testid="create-new-chat-button"] {
	background: revert !important;
	color: revert !important;
	border: revert !important;
	box-shadow: revert !important;
	border-radius: revert !important;
	transition: revert !important;
	transform: none !important;
	filter: none !important;
}
a[data-testid="create-new-chat-button"]:hover,
a[data-testid="create-new-chat-button"]:active {
	transform: none !important;
	filter: none !important;
}

 
/* ===== COSMO: composer should sit on OUR theme, not site gray ===== */

/* 0) Make the page itself keep your gradient everywhere */
html, body { background: var(--cosmo-bg) !important; background-attachment: fixed; }
#__next, main[role="main"], #main, #thread,
[data-testid="stretched-body"],
[class*="bg-token-main-surface-"] { background: transparent !important; }

/* 1) Scoped reset: only composer ancestors (exclude html/body/#__next) */
:where(main,section,div,footer,header,nav,article,aside,form):has(#prompt-textarea):not(#__next) {
	background: transparent !important;
	box-shadow: none !important;
	border: none !important;
}
:where(main,section,div,footer,header,nav,article,aside,form):has(#prompt-textarea):not(#__next)::before,
:where(main,section,div,footer,header,nav,article,aside,form):has(#prompt-textarea):not(#__next)::after {
	background: none !important;
	box-shadow: none !important;
	mask: none !important;
	-webkit-mask: none !important;
	opacity: 0 !important;
}

/* removed: legacy composer dock styling */

/* removed: legacy full-bleed underlay */

/* removed: duplicate textarea styles */
button[data-testid="composer-plus-btn"]{
	background: var(--cosmo-card) !important;
	border: 1px solid var(--cosmo-border) !important;
	box-shadow: var(--cosmo-glow); border-radius: 12px !important;
}
form:has(#prompt-textarea) button[type="submit"]{
	background: linear-gradient(135deg,var(--cosmo-accent-1),var(--cosmo-accent-2)) !important;
	color:#fff !important; border:none !important;
	box-shadow: 0 10px 24px rgba(0,0,0,.25), 0 2px 10px rgba(0,0,0,.2);
}

/* === Cosmo — sticky footer wrapper reset (kills the gray pad) === */
:where(div,section,footer)[class*="sticky"]:has(#prompt-textarea),
:where(div,section,footer)[style*="position: sticky"]:has(#prompt-textarea) {
	background: transparent !important;
	box-shadow: none !important;
	border: none !important;
}
:where(div,section,footer)[class*="sticky"]:has(#prompt-textarea)::before,
:where(div,section,footer)[class*="sticky"]:has(#prompt-textarea)::after,
:where(div,section,footer)[style*="position: sticky"]:has(#prompt-textarea)::before,
:where(div,section,footer)[style*="position: sticky"]:has(#prompt-textarea)::after {
	background: none !important;
	box-shadow: none !important;
	opacity: 0 !important;
}

/* === Cosmo: Unified Glass Composer === */
form:has(#prompt-textarea){
	background: var(--cosmo-card) !important;
	border: 1px solid var(--cosmo-border) !important;
	backdrop-filter: var(--cosmo-blur) !important;
	border-radius: 18px !important;
	box-shadow: var(--cosmo-glow) !important;
	padding: 10px 12px !important;
	transition: transform .12s ease, box-shadow .12s ease;
}

/* Textarea: transparent over glass with subtle inner definition */
#prompt-textarea{
	background: transparent !important;
	border: 1px solid color-mix(in oklab, var(--cosmo-border) 60%, transparent) !important;
	border-radius: 14px !important;
	padding: 12px 14px !important;
	min-height: 56px !important;
	color: var(--cosmo-text) !important;
	box-shadow: inset 0 2px 4px rgba(0,0,0,0.2) !important;
}

/* Focus state for the whole composer */
form:has(#prompt-textarea:focus-within){
	transform: translateY(-1px);
	box-shadow: var(--cosmo-glow), 0 0 0 2px color-mix(in oklab, var(--cosmo-accent-2) 35%, transparent);
}

/* Keep existing button styles */
form:has(#prompt-textarea) button{
	border-radius: 12px !important;
	transition: transform .12s ease, filter .12s ease, box-shadow .12s ease, background .12s ease;
}
form:has(#prompt-textarea) button[type="submit"]{
	background: linear-gradient(135deg,var(--cosmo-accent-1),var(--cosmo-accent-2)) !important;
	color:#fff !important; border:none !important;
	box-shadow: 0 10px 24px rgba(0,0,0,.25), 0 2px 10px rgba(0,0,0,.2);
}
form:has(#prompt-textarea) button[type="submit"]:hover{ transform: translateY(-1px); filter: brightness(1.05); }
form:has(#prompt-textarea) button[type="submit"]:active{ transform: translateY(0); filter: brightness(.98); }

button[data-testid="composer-plus-btn"]{
	background: var(--cosmo-card) !important;
	border: 1px solid var(--cosmo-border) !important;
	box-shadow: var(--cosmo-glow);
}
button[data-testid="composer-plus-btn"]:hover{ transform: translateY(-1px); }
button[data-testid="composer-plus-btn"]:active{ transform: translateY(0); }

/* removed: ambient underlay to prevent gray banding behind composer */
