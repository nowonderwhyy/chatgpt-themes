/* Contrast variant tweaks */
html[data-cosmo-theme="contrast"] #page-header,
html[data-cosmo-theme="contrast"] #stage-sidebar-tiny-bar,
html[data-cosmo-theme="contrast"] .bg-token-sidebar-surface-primary,
html[data-cosmo-theme="contrast"] [class*="bg-token-sidebar-surface-"] {
    background: var(--cosmo-card) !important;
}

/* --- Mocha fine-tuning for long reads --- */
html.dark[data-cosmo-theme="mocha"]::after{
    background:
        radial-gradient(60% 45% at 115% 115%, rgba(0,0,0,.30), transparent 62%),
        radial-gradient(90% 70% at 50% 120%, rgba(32,24,19,.24), transparent 60%),
        radial-gradient(50% 40% at 50% -10%, rgba(245,236,224,.05), transparent 60%);
    opacity: .9;
}

/* Mocha adjustments */
html[data-cosmo-theme="mocha"] * { scrollbar-color: #7a6a5a transparent; }
html[data-cosmo-theme="mocha"] ::selection { background: rgba(240, 225, 207, .35); color: #2a1e17; }
/* Desktop reading rhythm slightly softer */
@media (min-width: 1024px){
  html[data-cosmo-theme="mocha"] #thread { line-height: 1.68; }
}

/* Sepia-tinted code surfaces */
html[data-cosmo-theme="mocha"] #thread pre {
    background: rgba(32,24,19,.68);
    border-color: color-mix(in oklab, var(--cosmo-border) 70%, transparent);
}
html[data-cosmo-theme="mocha"] #thread code:not(pre code) {
    background: rgba(245,236,224,.10);
    border-color: color-mix(in oklab, var(--cosmo-border) 62%, transparent);
}

/* Link and quote polish */
html[data-cosmo-theme="mocha"] #thread a {
    color: color-mix(in oklab, var(--cosmo-accent-1) 78%, #ffffff 22%);
    text-decoration-color: color-mix(in oklab, var(--cosmo-accent-1) 55%, transparent);
}
html[data-cosmo-theme="mocha"] #thread a:hover {
    text-decoration-color: color-mix(in oklab, var(--cosmo-accent-1) 85%, transparent);
}
html[data-cosmo-theme="mocha"] #thread blockquote {
    background: rgba(245,236,224,.05);
    border-left: 3px solid color-mix(in oklab, var(--cosmo-accent-1) 35%, transparent);
}

/* Gentle typography for body text */
html[data-cosmo-theme="mocha"] #thread p,
html[data-cosmo-theme="mocha"] #thread li {
    letter-spacing: .003em;
    hyphens: auto;
}

/* ================= Sidebar Theme Variants ================ */

/* Sunset — espresso rail, copper polish */
html[data-cosmo-theme="sunset"] #stage-slideover-sidebar nav > .sticky.top-0,
html[data-cosmo-theme="sunset"] #stage-slideover-sidebar nav > aside[class*="sticky"],
html[data-cosmo-theme="sunset"] #stage-slideover-sidebar nav > .sticky.bottom-0 {
  border-color: var(--sb-divider);
}
html[data-cosmo-theme="sunset"] #stage-slideover-sidebar [__menu-item] svg,
html[data-cosmo-theme="sunset"] #stage-popover-sidebar [__menu-item] svg,
html[data-cosmo-theme="sunset"] a[data-testid^="sidebar-item-"] svg {
  color: var(--sb-icon-color);
  filter: brightness(1.06);
}
/* Avatar copper ring on hover */
html[data-cosmo-theme="sunset"] #stage-slideover-sidebar nav > .sticky.bottom-0 :is(img, .avatar, [class*="avatar"], .rounded-full):hover {
  box-shadow: 0 0 0 1px var(--sb-accent-bar);
  border-radius: 9999px;
}

/* Vapor — rim-light hover, teal marker */
html[data-cosmo-theme="vapor"] #stage-slideover-sidebar [__menu-item]:hover,
html[data-cosmo-theme="vapor"] #stage-popover-sidebar [__menu-item]:hover,
html[data-cosmo-theme="vapor"] a[data-testid^="sidebar-item-"]:hover {
  background: transparent !important;
}
html[data-cosmo-theme="vapor"] [__menu-item][aria-current="page"],
html[data-cosmo-theme="vapor"] [__menu-item][data-selected="true"],
html[data-cosmo-theme="vapor"] a[data-testid^="sidebar-item-"][aria-current="page"],
html[data-cosmo-theme="vapor"] a[data-testid^="sidebar-item-"][data-selected="true"] {
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
}

/* Mocha — ivory glyphs, bronze structure */
html[data-cosmo-theme="mocha"] #stage-slideover-sidebar [__menu-item],
html[data-cosmo-theme="mocha"] #stage-popover-sidebar [__menu-item],
html[data-cosmo-theme="mocha"] a[data-testid^="sidebar-item-"] {
  font-weight: 450;
}
html[data-cosmo-theme="mocha"] #stage-slideover-sidebar [__menu-item] svg,
html[data-cosmo-theme="mocha"] #stage-popover-sidebar [__menu-item] svg,
html[data-cosmo-theme="mocha"] a[data-testid^="sidebar-item-"] svg { color: #F5EFE6; }
html[data-cosmo-theme="mocha"] [__menu-item][aria-current="page"] svg,
html[data-cosmo-theme="mocha"] [__menu-item][data-selected="true"] svg,
html[data-cosmo-theme="mocha"] a[data-testid^="sidebar-item-"][aria-current="page"] svg,
html[data-cosmo-theme="mocha"] a[data-testid^="sidebar-item-"][data-selected="true"] svg {
  filter: drop-shadow(0 0 6px rgba(185, 138, 90, .25));
}
/* Section headers */
html[data-cosmo-theme="mocha"] #stage-slideover-sidebar :is(h2,h3,[role="heading"]) {
  text-transform: uppercase; font-size: 10.5px; letter-spacing: .06em;
  color: color-mix(in oklab, #caa078 80%, #F3E9DD 20%);
}

/* Nebula — faint rail wash + micro-motion */
html[data-cosmo-theme="nebula"] #stage-slideover-sidebar { position: relative; }
html[data-cosmo-theme="nebula"] #stage-slideover-sidebar::before {
  content: ""; position: absolute; inset: 0; pointer-events: none; border-radius: 12px 0 0 12px;
  background: linear-gradient(135deg, rgba(126,107,255,.06), rgba(0,0,0,0));
}
html[data-cosmo-theme="nebula"] #stage-slideover-sidebar [__menu-item] svg,
html[data-cosmo-theme="nebula"] #stage-popover-sidebar [__menu-item] svg,
html[data-cosmo-theme="nebula"] a[data-testid^="sidebar-item-"] svg { transition: transform .12s ease, filter .12s ease; }
html[data-cosmo-theme="nebula"] #stage-slideover-sidebar [__menu-item]:hover svg,
html[data-cosmo-theme="nebula"] #stage-popover-sidebar [__menu-item]:hover svg,
html[data-cosmo-theme="nebula"] a[data-testid^="sidebar-item-"]:hover svg {
  transform: scale(1.03);
  filter: drop-shadow(0 2px 6px rgba(126,107,255,.18));
}

/* Sakura — petal-tinted selection, gentle code panels, link/quote tones */
html[data-cosmo-theme="sakura"] ::selection { background: rgba(255,218,236,.35); color: #2a1320; }
html[data-cosmo-theme="sakura"] #thread pre {
  background: rgba(26,18,23,.68);
  border-color: color-mix(in oklab, var(--cosmo-border) 65%, transparent);
}
html[data-cosmo-theme="sakura"] #thread code:not(pre code) {
  background: rgba(255,234,244,.10);
  border-color: color-mix(in oklab, var(--cosmo-border) 55%, transparent);
}
html[data-cosmo-theme="sakura"] #thread a {
  color: color-mix(in oklab, var(--cosmo-accent-1) 85%, #fff 15%);
  text-decoration-color: color-mix(in oklab, var(--cosmo-accent-1) 60%, transparent);
}
html[data-cosmo-theme="sakura"] #thread blockquote {
  background: rgba(255,234,244,.07);
  border-left: 3px solid color-mix(in oklab, var(--cosmo-accent-1) 35%, transparent);
}

/* Glacier tweaks: selection, code blocks, links, quotes */
html[data-cosmo-theme="glacier"] ::selection { background: rgba(125,227,255,.28); color:#0b1a22; }
html[data-cosmo-theme="glacier"] #thread pre {
  background: rgba(14,22,30,.72);
  border-color: color-mix(in oklab, var(--cosmo-border) 65%, transparent);
}
html[data-cosmo-theme="glacier"] #thread code:not(pre code) {
  background: rgba(125,227,255,.10);
  border-color: color-mix(in oklab, var(--cosmo-border) 55%, transparent);
}
html[data-cosmo-theme="glacier"] #thread a {
  /* slightly warmer body text feel via link tone */
  color: color-mix(in oklab, var(--cosmo-accent-1) 76%, #fff 24%);
  text-decoration-color: color-mix(in oklab, var(--cosmo-accent-1) 55%, transparent);
}
html[data-cosmo-theme="glacier"] #thread blockquote {
  background: rgba(125,227,255,.06);
  border-left: 3px solid color-mix(in oklab, var(--cosmo-accent-1) 35%, transparent);
}

/* Sunset — lighten code blocks a touch for warm palettes */
html[data-cosmo-theme="sunset"] #thread pre {
  background: rgba(0,0,0,.31);
  border-color: color-mix(in oklab, var(--cosmo-border) 70%, transparent);
}
html[data-cosmo-theme="sunset"] #thread code:not(pre code) {
  background: rgba(255,255,255,.08);
  border-color: color-mix(in oklab, var(--cosmo-border) 62%, transparent);
}

/* Orchid — companion to native purple bubbles */
html[data-cosmo-theme="orchid"] ::selection { background: rgba(126,107,255,.28); color:#1a132a; }
html[data-cosmo-theme="orchid"] #thread pre {
  background: rgba(18, 16, 28, .72);
  border-color: color-mix(in oklab, var(--cosmo-border) 65%, transparent);
}
html[data-cosmo-theme="orchid"] #thread code:not(pre code) {
  background: rgba(126,107,255,.10);
  border-color: color-mix(in oklab, var(--cosmo-border) 55%, transparent);
}
html[data-cosmo-theme="orchid"] #thread a {
  color: color-mix(in oklab, var(--cosmo-accent-1) 82%, #fff 18%);
  text-decoration-color: color-mix(in oklab, var(--cosmo-accent-1) 58%, transparent);
}
html[data-cosmo-theme="orchid"] #thread blockquote {
  background: rgba(126,107,255,.06);
  border-left: 3px solid color-mix(in oklab, var(--cosmo-accent-1) 35%, transparent);
}
